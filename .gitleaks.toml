# Git-leaks configuration for AutoQA Pilot
# Detects secrets, API keys, and sensitive information in git history

title = "AutoQA Pilot Git-leaks Configuration"

[extend]
# Use default rules as base
useDefault = true

[[rules]]
id = "autoqa-api-key"
description = "AutoQA API Key"
regex = '''(?i)(autoqa[_-]?api[_-]?key|x-api-key)\s*[:=]\s*['"]?([a-zA-Z0-9]{20,})['"]?'''
tags = ["api-key", "autoqa"]

[[rules]]
id = "webhook-secret"
description = "Webhook Secret"
regex = '''(?i)(webhook[_-]?secret|x-hub-signature)\s*[:=]\s*['"]?([a-zA-Z0-9]{16,})['"]?'''
tags = ["webhook", "secret"]

[[rules]]
id = "github-token"
description = "GitHub Token"
regex = '''(?i)(github[_-]?token|gh[ps]_[a-zA-Z0-9]{36})'''
tags = ["github", "token"]

[[rules]]
id = "database-url"
description = "Database Connection String"
regex = '''(?i)(database[_-]?url|db[_-]?url|connection[_-]?string)\s*[:=]\s*['"]?(postgresql|mysql|mongodb)://[^\s'"]+['"]?'''
tags = ["database", "connection"]

[[rules]]
id = "redis-url"
description = "Redis Connection String"
regex = '''(?i)(redis[_-]?url)\s*[:=]\s*['"]?redis://[^\s'"]+['"]?'''
tags = ["redis", "connection"]

[[rules]]
id = "jwt-secret"
description = "JWT Secret"
regex = '''(?i)(jwt[_-]?secret|token[_-]?secret)\s*[:=]\s*['"]?([a-zA-Z0-9+/]{32,})['"]?'''
tags = ["jwt", "secret"]

[[rules]]
id = "encryption-key"
description = "Encryption Key"
regex = '''(?i)(encryption[_-]?key|crypto[_-]?key|aes[_-]?key)\s*[:=]\s*['"]?([a-fA-F0-9]{32,})['"]?'''
tags = ["encryption", "key"]

[[rules]]
id = "private-key"
description = "Private Key"
regex = '''-----BEGIN (RSA |EC |OPENSSH |DSA )?PRIVATE KEY-----'''
tags = ["private-key", "certificate"]

[[rules]]
id = "aws-access-key"
description = "AWS Access Key"
regex = '''(?i)(aws[_-]?access[_-]?key[_-]?id|access[_-]?key)\s*[:=]\s*['"]?(AKIA[0-9A-Z]{16})['"]?'''
tags = ["aws", "access-key"]

[[rules]]
id = "aws-secret-key"
description = "AWS Secret Key"
regex = '''(?i)(aws[_-]?secret[_-]?access[_-]?key|secret[_-]?key)\s*[:=]\s*['"]?([a-zA-Z0-9+/]{40})['"]?'''
tags = ["aws", "secret-key"]

[[rules]]
id = "docker-config"
description = "Docker Config with Auth"
regex = '''(?i)"auth"\s*:\s*"[a-zA-Z0-9+/=]{20,}"'''
tags = ["docker", "auth"]

# Allowlist for test files and documentation
[allowlist]
description = "Allowlist for test files and documentation"
files = [
    '''.*test.*\.ts$''',
    '''.*test.*\.js$''',
    '''.*spec.*\.ts$''',
    '''.*spec.*\.js$''',
    '''.*\.md$''',
    '''.*\.example$''',
    '''.*\.sample$''',
    '''.*\.template$''',
]

# Allowlist for specific patterns that are safe
regexes = [
    '''test-api-key-123''',
    '''example-secret''',
    '''placeholder-key''',
    '''dummy-token''',
    '''fake-password''',
    '''mock-credential''',
    '''sample-key''',
    '''demo-secret''',
]

# Allowlist for specific commits (if needed)
commits = [
    # Add commit hashes here if needed to ignore specific commits
]

# Paths to ignore completely
paths = [
    '''node_modules/''',
    '''.git/''',
    '''dist/''',
    '''build/''',
    '''coverage/''',
    '''.turbo/''',
    '''logs/''',
]